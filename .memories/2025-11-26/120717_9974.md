---
git:
  branch: main
  commit: fb0ac89
  dirty: true
  files_changed:
  - TODO.md
  - python/miller/embeddings/manager.py
  - python/tests/test_embeddings.py
  - .memories/2025-11-26/113518_771d.md
  - .memories/2025-11-26/114804_19e3.md
id: checkpoint_fe05f0cf_ee2047
tags:
- bugfix
- directml
- windows
- embeddings
- gpu
timestamp: 1764180437
type: checkpoint
---

Fixed DirectML not working on Windows: EmbeddingManager was passing "dml" string to SentenceTransformer, but PyTorch doesn't understand "dml" - it needs the actual torch.device from torch_directml.device() (returns "privateuseone:0"). Added device_type property for logging/display, device holds actual PyTorch device. Added test with mocks to verify correct behavior.
