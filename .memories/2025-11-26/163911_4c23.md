---
git:
  branch: main
  commit: '8834447'
  dirty: true
  files_changed:
  - python/miller/embeddings/manager.py
id: checkpoint_8eb9c31e_c865bc
tags:
- bugfix
- directml
- embeddings
- windows
- gpu
timestamp: 1764196751
type: checkpoint
---

Fixed DirectML not working for embeddings: (1) torch-directml wasn't installed - added via uv. (2) DirectML throws "Cannot set version_counter for inference tensor" with torch.inference_mode() - patched at module level before importing sentence_transformers to use torch.no_grad() instead. Now embedding generation uses GPU via DirectML on Windows.
